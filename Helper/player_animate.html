<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Whale Sprite Animation Demo</title>
<style>
    :root {
        --bg-color: #e0f7fa;
        --ground-color: #4dd0e1;
        --text-color: #006064;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg-color);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        overflow: hidden;
    }

    h1 {
        color: var(--text-color);
        margin-bottom: 20px;
    }

    .stage {
        position: relative;
        width: 100%;
        height: 400px;
        display: flex;
        justify-content: center;
        align-items: flex-end;
        padding-bottom: 50px;
        border-bottom: 10px solid var(--ground-color);
        background: linear-gradient(to top, rgba(77, 208, 225, 0.2), transparent);
    }

    /* Controls */
    .controls {
        margin-top: 30px;
        display: flex;
        gap: 15px;
        z-index: 10;
    }

    button {
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        background-color: #00bcd4;
        color: white;
        cursor: pointer;
        transition: transform 0.1s, background-color 0.2s;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    button:hover {
        background-color: #0097a7;
        transform: translateY(-2px);
    }

    button:active {
        transform: translateY(0);
    }

    button.active {
        background-color: #006064;
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
    }

    /* --- SVG CLASSES & ANIMATIONS --- */
    
    .whale-svg {
        width: 200px;
        height: 200px;
        overflow: visible; /* Important for jumping out of bounds */
    }

    /* Group Origins for Rotation */
    #group-body {
        transform-origin: 512px 900px; /* Pivot at bottom center */
        transition: transform 0.3s ease;
    }
    
    #group-hat {
        transform-origin: 512px 350px; /* Pivot at center of head */
        transition: transform 0.3s ease;
    }

    #group-flippers {
        transform-origin: 512px 750px;
        transition: transform 0.3s ease;
    }

    /* --- IDLE STATE --- */
    .state-idle #group-body {
        animation: idle-body 2s ease-in-out infinite;
    }
    .state-idle #group-hat {
        animation: idle-hat 2s ease-in-out infinite;
    }
    .state-idle #group-flippers {
        animation: idle-flippers 2s ease-in-out infinite;
    }

    @keyframes idle-body {
        0%, 100% { transform: scale(1, 1) translateY(0); }
        50% { transform: scale(1.02, 0.98) translateY(10px); }
    }
    @keyframes idle-hat {
        0%, 100% { transform: rotate(0deg) translateY(0); }
        50% { transform: rotate(2deg) translateY(12px); }
    }
    @keyframes idle-flippers {
        0%, 100% { transform: rotate(0deg); }
        50% { transform: rotate(-5deg); }
    }

    /* --- SWIM STATE (Formerly Run) --- */
    .state-swim #group-body {
        animation: swim-body 0.6s ease-in-out infinite;
    }
    .state-swim #group-hat {
        animation: swim-hat 0.6s ease-in-out infinite;
        animation-delay: 0.1s; /* Lag behind body */
    }
    .state-swim #group-flippers {
        animation: swim-flippers 0.6s ease-in-out infinite;
    }

    @keyframes swim-body {
        0%, 100% { transform: rotate(-5deg) translateY(0); }
        50% { transform: rotate(5deg) translateY(-10px); }
    }
    @keyframes swim-hat {
        0%, 100% { transform: rotate(5deg) translateY(0); }
        50% { transform: rotate(-5deg) translateY(-5px); }
    }
    @keyframes swim-flippers {
        0%, 100% { transform: translateY(0) rotate(-10deg); }
        50% { transform: translateY(-20px) rotate(10deg); }
    }

    /* --- FAST RUN STATE (New) --- */
    .state-run #group-body {
        animation: run-body 0.4s cubic-bezier(0.42, 0, 0.58, 1) infinite;
    }
    .state-run #group-hat {
        animation: run-hat 0.4s ease-in-out infinite;
        animation-delay: 0.05s;
    }
    .state-run #group-flippers {
        animation: run-flippers 0.4s ease-in-out infinite;
    }

    @keyframes run-body {
        0% { transform: rotate(5deg) translateY(0) scale(1.1, 0.9); } /* Land/Squash */
        25% { transform: rotate(10deg) translateY(-15px) scale(1, 1); } /* Push off */
        50% { transform: rotate(15deg) translateY(-40px) scale(0.9, 1.1); } /* Air/Stretch */
        75% { transform: rotate(10deg) translateY(-15px) scale(1, 1); } 
        100% { transform: rotate(5deg) translateY(0) scale(1.1, 0.9); }
    }
    
    @keyframes run-hat {
        0%, 100% { transform: rotate(0deg) translateY(5px); }
        50% { transform: rotate(-15deg) translateY(-15px); }
    }

    @keyframes run-flippers {
        0%, 100% { transform: rotate(-20deg); }
        50% { transform: rotate(60deg); } /* Wild flapping */
    }

    /* --- JUMP STATE --- */
    /* This overrides other states when applied */
    .state-jump #group-body {
        animation: jump-body 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    }
    .state-jump #group-hat {
        animation: jump-hat 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    }
    .state-jump #group-flippers {
        animation: jump-flippers 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    }

    @keyframes jump-body {
        0% { transform: scale(1.2, 0.8) translateY(50px); } /* Squash */
        20% { transform: scale(0.9, 1.1) translateY(-150px); } /* Stretch Up */
        50% { transform: scale(1, 1) translateY(-200px); } /* Peak */
        80% { transform: scale(0.95, 1.05) translateY(0); } /* Land Stretch */
        100% { transform: scale(1, 1) translateY(0); } /* Recover */
    }
    
    @keyframes jump-hat {
        0% { transform: translateY(50px) rotate(0); }
        20% { transform: translateY(-130px) rotate(-10deg); } /* Hat lags behind */
        50% { transform: translateY(-220px) rotate(0); } /* Hat flies up */
        80% { transform: translateY(10px) rotate(10deg); } 
        100% { transform: translateY(0) rotate(0); }
    }

    @keyframes jump-flippers {
        0% { transform: rotate(0); }
        20% { transform: rotate(45deg); } /* Hands up! */
        80% { transform: rotate(-10deg); }
        100% { transform: rotate(0); }
    }

    .instructions {
        margin-top: 20px;
        color: #666;
        font-size: 0.9rem;
    }

</style>
</head>
<body>

    <h1>Sprite Animation Demo</h1>

    <div class="stage">
        <!-- SVG Container -->
        <div id="whale-container" class="state-idle">
            <svg class="whale-svg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <!-- 
                   Group 1: The Flippers (Back layer)
                   We group both left and right flippers here.
                -->
                <g id="group-flippers">
                    <!-- Right Flipper (Visual Left) -->
                    <path d="M377.299 739.92l24.86-21.55a2.5 2.5 0 0 0-0.15-3.92l-12.96-9.63a2.6 2.6 0 0 0-3.24 0.12c-25.43 19.79-38.42 29.82-38.98 30.11l-13.84 7.19a10.85 10.85 0 0 0-3.62 3.04 10.64 10.64 0 0 0 2.14 15.04l61.29 45.89c0.77 0.57 1.8 0.67 2.66 0.26l12.81-6.1c0.78-0.37 1.21-1.4 1.32-3.08-4.42-12.99-15.66-27.35-22.68-34.15-1.8-1.74-4.89-4.35-9.28-7.82a9.99 9.99 0 0 1-1.63-14.03c0.38-0.5 0.82-0.95 1.29-1.36z" fill="#FFC62E"/>
                    <path d="M345.038 727.05a1996.8 1996.8 0 0 0 7.38-5.67c6.47-5 16.03-12.42 28.69-22.26a10.09 10.09 0 0 1 12.42-0.3l12.96 9.62a10 10 0 0 1 0.59 15.6l-24.86 21.55a2.5 2.5 0 0 0 0.09 3.85c4.57 3.61 7.82 6.36 9.84 8.32 9.66 9.36 20.28 24.54 24.56 37.11l0.47 1.4-0.09 1.48c-0.25 4.12-1.72 7.56-5.57 9.4l-12.81 6.1a10.1 10.1 0 0 1-10.37-1.02l-61.27-45.88a18.13 18.13 0 0 1-3.63-25.6 18.35 18.35 0 0 1 6.12-5.13l13.4-6.97c0.64-0.47 1.27-0.95 2.09-1.57z m45.68-16.44l-0.2 0.16c0.07-0.05 0.14-0.1 0.2-0.16z m-9.01 57.9c-1.58-1.53-4.51-4-8.71-7.33a17.48 17.48 0 0 1-0.6-26.92l20.18-17.49-4.99-3.7c-27.73 21.56-36.08 28.01-37.29 28.64l-13.84 7.19a3.36 3.36 0 0 0-1.12 0.94c-1.08 1.41-0.8 3.38 0.68 4.48l58.91 44.11 5.95-2.84c-4.21-9.35-12.14-20.28-19.17-27.08z" fill="#524F75"/>
                    <!-- Left Flipper (Visual Right) -->
                    <path d="M612.639 747.45l-24.29-37a2.51 2.51 0 0 0-3.25-0.86l-14.29 7.35c-1.41 0.92-1.72 2.5-0.96 3.67l41.25 76.41a10.91 10.91 0 0 0 2.45 3.95 10.69 10.69 0 0 0 15.21 0.14l54.83-54.33c1.05-1.21 0.94-2.81-0.11-3.74-7.29-6.08-11.19-9.08-11.69-8.99-13.89 2.53-24.77 6.84-32.62 12.94a74.75 74.75 0 0 0-4.01 3.4v-0.002a14.99 14.99 0 0 1-22.52-2.94z" fill="#FFC62E"/>
                    <path d="M566.702 710.67l0.33-0.22 14.64-7.53a10.01 10.01 0 0 1 12.94 3.41l24.29 37a7.49 7.49 0 0 0 11.26 1.47 81 81 0 0 1 4.42-3.74c8.91-6.91 20.88-11.65 35.87-14.39a7.35 7.35 0 0 1 3.75 0.25c0.48 0.15 0.9 0.34 1.31 0.54 0.47 0.24 0.92 0.51 1.42 0.84 0.73 0.48 1.62 1.13 2.72 1.98 2.04 1.57 4.91 3.9 8.76 7.12 4.24 3.72 4.51 10.05 0.83 14.29l-0.38 0.41-54.83 54.33a18.19 18.19 0 0 1-25.86-0.24 18.2 18.2 0 0 1-3.91-6.06l-40.91-75.77c-2.83-4.71-1.29-10.66 3.34-13.69z m77.06 42.25c-0.88 0.68-2.09 1.71-3.6 3.06-9.25 8.28-23.46 7.49-31.74-1.76a22.14 22.14 0 0 1-2.04-2.65l-21.84-33.26-5.8 2.98 39.24 72.68 0.19 0.55c0.16 0.46 0.43 0.88 0.76 1.23a3.2 3.2 0 0 0 4.57 0.04l50.95-50.49a171.3 171.3 0 0 0-3.92-3.12c-0.08-0.06-0.16-0.13-0.25-0.19-11.4 2.36-20.23 6.04-26.53 10.92z" fill="#524F75"/>
                </g>

                <!-- 
                   Group 2: The Body (Middle layer)
                   Contains blue body, white belly, eyes
                -->
                <g id="group-body">
                    <path d="M433.97 510.67c-77.7-6.41-104.8-21.89-110.01-42.77-5.2-20.88 35.48-43.55 109.85-65.3" fill="#3D96C8"/>
                    <path d="M436.35 500.67c-69.13-2.08-99.5-13.13-105.16-31.65-4.22-13.8 31.12-37.02 101.59-61.7a7.49 7.49 0 1 0-4.96-14.14c-79.5 27.85-119.04 53.82-110.97 80.22 8.25 27 43.92 39.99 119.04 42.25a7.49 7.49 0 1 0 0.45-14.98z" fill="#524F75"/>
                    <path d="M343.12 707.1c28.68 17.62 90.11 29.19 142.22 29.68 21.9 0.2 61.47-4.55 118.73-14.24 33.99-9.54 58.62-22.17 62.59-71.1 5.77-71.14 6.71-117.51 2.81-139.1-3.15-17.48-8.7-48.07-16.65-91.76C641.4 357.8 587 312.2 523.51 312.2H493.84c-63.06 0-117.23 45.02-129.1 107.28L336 580.91c-2.42 13.58-15.39 22.63-28.97 20.22a25.03 25.03 0 0 1-8.71-3.32l-6.36-3.91c-5.55-2.86-15.52 1.09-19.33 7.02-3.81 5.93 4.32 35.92 10.8 47.18 6.48 11.24 31.02 41.38 59.7 59z" fill="#3D96C8"/>
                    <path d="M339.2 713.48c-25.09-15.41-52.12-44.02-62.27-61.66-8.47-14.73-16.21-46.26-10.61-54.97 5.85-9.1 19.9-14.35 29.07-9.63l6.85 4.19a17.48 17.48 0 0 0 26.38-11.82l28.75-161.52C369.92 352.28 427.18 304.7 493.84 304.7h29.68c67.1 0 124.61 48.2 136.68 114.53 7.95 43.7 13.5 74.29 16.66 91.78 4.05 22.45 3.1 69.21-2.72 141.03-2.03 25-9.33 42.65-22.31 55.12-10.8 10.36-24.3 16.58-45.72 22.59-58.45 9.94-98.36 14.73-120.83 14.52-55.59-0.51-117.06-12.96-146.06-30.78z m-59.94-104.92c0.28 3.27 1.04 7.5 2.19 12.16 2.27 9.26 5.72 18.84 8.48 23.63 8.94 15.53 34.23 42.3 57.13 56.36 26.25 16.13 85.24 28.07 138.36 28.57 21.27 0.19 60.39-4.49 117.02-14.07 19.02-5.36 30.46-10.66 39.01-18.86 10.12-9.72 16-23.94 17.76-45.52 5.71-70.47 6.64-116.44 2.9-137.16-3.15-17.48-8.7-48.06-16.65-91.75C634.67 362.7 583.36 319.69 523.51 319.69H493.84C434.38 319.69 383.3 362.14 372.11 420.79l-28.74 161.43c-3.14 17.65-20 29.42-37.66 26.28a32.4 32.4 0 0 1-11.33-4.32l-6.01-3.7c-1.77-0.66-7.01 1.3-9.16 4.05-0.12 1.21-0.1 2.48 0.03 4.02z" fill="#524F75"/>
                    <path d="M645.87 424.31a52914.73 52914.73 0 0 1 16.19 88.54c3.79 20.83 2.87 65.57-2.74 134.21-3.86 47.21-27.81 59.4-60.87 68.6-55.68 9.36-94.17 13.94-115.47 13.74-14.28-0.13-30.21-1.51-46.18-3.64a38.42 38.42 0 0 1 8.37-7.48c24.85-16.37 40.28-63.52 42.71-78.31 4.94-30.06 5.45-66.57 5.12-172.68-0.17-56.56 40.44-105 96.16-114.7a85.61 85.61 0 0 1 15.18-1.27A127.17 127.17 0 0 1 645.87 424.31z" fill="#FFFFFF"/>
                    
                    <!-- Left Eye -->
                    <path d="M618.15 419.73a45.31 36.24 90 1 0 72.48 0 45.31 36.24 90 1 0-72.48 0Z" fill="#FFFFFF"/>
                    <path d="M655.9 460.94c21.15 0 37.71-19.81 37.71-43.65s-16.56-43.65-37.71-43.65-37.71 19.81-37.71 43.65 16.56 43.65 37.71 43.65z m0-14.99c-12.23 0-22.72-12.57-22.72-28.67s10.5-28.67 22.72-28.67 22.72 12.57 22.72 28.67-10.5 28.67-22.72 28.67z" fill="#524F75"/>
                    <path d="M672.24 424.15c-1.71 2.23-4.23 3.64-7.04 3.64-5.14 0-9.3-4.7-9.3-10.5s4.16-10.5 9.3-10.5c5.07 0 9.2 4.59 9.3 10.28l-6.89 1.13 4.63 5.95z" fill="#232323"/>
                    
                    <!-- Cheek Detail -->
                    <path d="M626 530.87c12.84-1 23.95-1.38 43.79-15.98 8.27-6.09 23.25-18.33 30.24-26.73 6.62-7.95 4.5-17.55 0-23.92-9.26-13.09-23.11-13.83-38.8-18.73-6.03-1.88-19.94-5.88-37.74-9.27 4.56 13.59 6.57 29.98 6.02 49.15-0.47 16.74-1.64 31.9-3.51 45.48z" fill="#FFC62E"/>
                    <path d="M636.91 478.25c1.69-14.58 1.82-27.8 0.36-39.68 9.36 2.97 17.74 6.03 24.42 8.78 1.84 0.76 3.74 1.49 5.93 2.29 0.85 0.31 1.71 0.62 2.82 1.02l2.7 0.97c12.95 4.66 17.93 7.72 21.95 14.61 3.08 5.27 2.94 10.87-0.93 14.77-6.09 6.14-19.92 16.09-31.04 22.87-12.86 7.84-21.23 10.49-31.85 10.97 2.23-11.21 4.11-23.41 5.64-36.6z m-14.98 51.62l1.64 0.02c2.23 0.02 3.42 0.03 4.78 0.02 14.8-0.12 26.14-3.22 42.57-13.23 12.07-7.35 26.74-17.92 33.88-25.11 9.15-9.22 9.47-22.21 3.23-32.88-6.29-10.77-13.81-15.39-29.82-21.15l-2.72-0.97c-1.08-0.39-1.91-0.69-2.71-0.98a144.53 144.53 0 0 1-5.4-2.09c-9.85-4.05-23-8.68-37.6-12.8-5.51-1.56-10.66 3.4-9.32 8.97 3.13 13.01 3.67 28.64 1.56 46.87-1.9 16.38-4.35 31.11-7.33 44.2a7.49 7.49 0 0 0 7.24 9.15z" fill="#524F75"/>
                    
                    <!-- Right Eye -->
                    <path d="M540.72 424.73a45.31 36.24 90 1 0 72.48 0 45.31 36.24 90 1 0-72.48 0Z" fill="#FFFFFF"/>
                    <path d="M578.39 478.33c26.75 0 48.17-23.34 48.17-51.82 0-28.48-21.41-51.82-48.17-51.82-26.75 0-48.17 23.34-48.17 51.82 0 28.48 21.41 51.82 48.17 51.82z m0-15c-18.17 0-33.18-16.35-33.18-36.83 0-20.48 15-36.83 33.18-36.83s33.18 16.35 33.18 36.83c0 20.48-15 36.83-33.18 36.83z" fill="#524F75"/>
                    <path d="M599.69 437.99c-2.35 2.97-5.81 4.85-9.68 4.85-7.06 0-12.79-6.27-12.79-14s5.73-14 12.79-14c6.98 0 12.64 6.11 12.78 13.71l-9.48 1.51 6.38 7.92z" fill="#232323"/>
                    
                    <path d="M308.82 609.23c12.93 2.7 23.48 3.6 31.77 2.63 8.03-0.94 14.24-3.58 19.78-7.71 1.8-1.34 5.85-4.87 6.24-5.16a7.49 7.49 0 0 0 1.68-10.46 7.49 7.49 0 0 0-10.46-1.68c-1.1 0.79-5.26 4.42-6.42 5.28-3.52 2.62-7.28 4.22-12.57 4.84-6.44 0.75-15.48-0.02-26.97-2.42a7.49 7.49 0 1 0-3.05 14.67z" fill="#524F75"/>
                    <path d="M401.51 578.1c-77.7-6.41-104.8-21.89-110.01-42.76s35.48-43.55 109.85-65.3" fill="#3D96C8"/>
                    <path d="M402.73 569.8c-69.02-4.49-98.98-16.6-103.99-35.3-3.74-13.94 32.39-35.91 103.68-58.12a7.49 7.49 0 1 0-4.46-14.3C317.53 487.13 277.12 511.7 284.26 538.37c7.31 27.27 42.5 41.5 117.49 46.37a7.49 7.49 0 1 0 0.97-14.95z" fill="#524F75"/>
                    <path d="M427.09 579.43m-9.99 0a9.99 9.99 0 1 0 19.98 0 9.99 9.99 0 1 0-19.98 0Z" fill="#524F75"/>
                </g>

                <!-- 
                   Group 3: The Hat (Top layer)
                -->
                <g id="group-hat">
                    <path d="M564.56 345.49c48.27-15.68 79.4-65.03 71.22-90.23-8.19-25.2-57.61 18.56-105.88 34.25-48.27 15.68-114.22 26.39-106.03 51.59 8.19 25.19 92.42 20.07 140.7 4.39z" fill="#FFD04F"/>
                    <path d="M564.88 354.21c-25.51 6.84-59.66 10.3-88.26 8.9-34.08-1.68-56.8-9.51-61.2-25.94-3.8-14.17 5.78-24.27 24.58-31.94 12.48-5.09 24.87-8.3 56.09-15.3l4.64-1.04c12.7-2.86 20.75-4.77 28.57-6.87 6.14-1.65 12.64-3.84 19.68-6.59 7.98-3.12 15.78-6.57 27.15-11.88 27.78-12.98 31.49-14.61 40.65-17.05 14.88-3.96 25.75-0.79 29.22 12.15 8.74 32.63-31.9 82.36-81.13 95.56z m-3.88-14.47c21.42-5.74 41.16-19.07 55-36.02 12.45-15.24 18.18-31.26 15.53-41.18-0.81-3.03-2.97-3.66-10.89-1.55-7.85 2.09-11.68 3.77-38.16 16.15-11.64 5.44-19.69 9-28.04 12.27-7.52 2.94-14.53 5.3-21.25 7.1-8.07 2.16-16.28 4.11-29.17 7.01l-4.65 1.05c-30.27 6.78-42.32 9.9-53.7 14.55-12.63 5.15-16.96 9.73-15.77 14.19 4.53 16.91 78.48 20.55 131.1 6.45z" fill="#524F75"/>
                    <path d="M495.95 342.91c32.91-16.51 59.59-47.05 54.36-64.17-5.23-17.13-41.17-44.47-112.31-22.25-71.16 22.23-74.05 89.13-65.86 114.33 8.19 25.2 90.9-11.4 123.81-27.91z" fill="#FD6B4D"/>
                    <path d="M426.14 248.54c20.57 13.44 41.18 26.42 51.96 37.5 9.11 9.38 20.96 26.37 35.54 50.99 2.66 4.5-61.5 37.06-62.89 33.89-10.15-23.15-16.75-41.83-19.78-56.05-3.45-16.16-5.34-44.74-4.83-66.33z m3.21 0c30.73-7.79 55.48-10.7 75.63-9.41 20.15 1.29 36.29 18.56 57.35 37.11L556.38 308.04c-17.9-21.48-33.18-37.53-45.85-48.14-8.85-7.41-24.75-12.75-47.69-16.02-9.9-1.41-20.97 5.29-33.49 4.66z m-14.02 4.46c-19.22 37.53-26.05 53.95-23.2 70.22 2.85 16.27 8.22 37.51 16.1 63.7L362.07 380.29c-0.22-4.94-3.55-9.29-3.54-13.89 0.07-26.37 3.92-47.26 11.55-62.66 8.96-18.1 23.13-28.02 45.25-50.74z" fill="#FF8B74"/>
                    <path d="M494 344.99c33.73-14.77 61.97-43.86 57.65-61.24-4.32-17.38-38.78-46.57-111-28.1-72.22 18.47-78.6 85.13-71.75 110.72 6.86 25.59 91.38-6.62 125.11-21.39zM425.08 385.34c-15.43 3.94-28.49 5.94-39.04 5.55-15.82-0.59-27.89-6.71-31.62-20.63-5.03-18.79-3.04-45.18 6.98-67.95 13.1-29.74 38.33-51.65 75.53-61.17 35.76-9.15 66.32-8.22 90.17 1.17 20.6 8.11 35.3 22.59 39.09 37.82 6.63 26.68-25.99 60.99-66.18 78.59-23.79 10.41-51.73 20.69-74.93 26.62z" fill="#524F75"/>
                    <path d="M440.78 241.58a15.21 15.25 75 1 0-29.46 7.89 15.21 15.25 75 1 0 29.46-7.89Z" fill="#FFD04F"/>
                    <path d="M431.29 265.04c-10.8 2.89-21.89-3.49-24.78-14.27-2.89-10.78 3.53-21.86 14.32-24.75 10.79-2.89 21.89 3.49 24.78 14.27 2.89 10.78-3.53 21.86-14.32 24.75z m-2.58-9.65a10.23 10.23 0 0 0 7.26-12.52 10.23 10.23 0 0 0-12.54-7.21 10.23 10.23 0 0 0-7.26 12.52 10.23 10.23 0 0 0 12.55 7.21z" fill="#524F75"/>
                </g>
            </svg>
        </div>
    </div>

    <div class="controls">
        <button id="btn-idle" class="active" onclick="setAnimation('idle')">Idle</button>
        <button id="btn-swim" onclick="setAnimation('swim')">Swim</button>
        <button id="btn-run" onclick="setAnimation('run')">Run (Fast)</button>
        <button id="btn-jump" onclick="triggerJump()">Jump!</button>
    </div>

    <div class="instructions">
        (Or press SPACE to jump)
    </div>

    <script>
        const whaleContainer = document.getElementById('whale-container');
        const buttons = document.querySelectorAll('button');

        function setAnimation(state) {
            // Remove jump immediately to switch states
            whaleContainer.classList.remove('state-jump');
            
            // Toggle Main States
            whaleContainer.classList.remove('state-idle', 'state-swim', 'state-run');
            whaleContainer.classList.add(`state-${state}`);

            // Update Buttons
            buttons.forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${state}`).classList.add('active');
        }

        function triggerJump() {
            // Re-trigger reflow to allow jumping while already jumping
            whaleContainer.classList.remove('state-jump');
            void whaleContainer.offsetWidth; 
            whaleContainer.classList.add('state-jump');
        }

        // Add keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                triggerJump();
            }
        });
    </script>
</body>
</html>